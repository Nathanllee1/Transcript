(this.webpackJsonptranscode2=this.webpackJsonptranscode2||[]).push([[0],{28:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(0),a=n.n(c),s=n(19),u=n.n(s),i=(n(28),n(11)),o=n(2),d=n.n(o),l=n(4),p=n(3),b=n(10),j=n(20),f=n.n(j),h=(n(56),n(21));var x=function(e){var t=Object(c.useState)(""),n=Object(p.a)(t,2),a=n[0],s=n[1];return console.log(e.aud),(new FormData).append("data",e.aud),fetch("/speechToText",{method:"post",headers:{"Content-Type":"application/octet-stream"},body:e.aud}).then((function(e){return e.json()})).then((function(e){return s(e.text)})),Object(r.jsx)("div",{children:Object(r.jsxs)("div",{className:"slide",children:[Object(r.jsx)("p",{className:"timeStamp",children:e.time}),Object(r.jsx)("video",{src:e.vid,width:"32%",controls:!0}),Object(r.jsx)("p",{className:"text",children:a})]})})};n(12),n(22);var O=function(){var e,t=Object(c.useState)(),n=Object(p.a)(t,2),a=n[0],s=n[1],u=Object(c.useState)(),o=Object(p.a)(u,2),j=o[0],O=o[1],m=Object(c.useState)([]),v=Object(p.a)(m,2),w=v[0],g=v[1],k=Object(c.useRef)(null),S=Object(c.useRef)(null),y=Object(c.useState)(),F=Object(p.a)(y,2),T=(F[0],F[1],Object(c.useState)()),L=Object(p.a)(T,2),N=(L[0],L[1],Object(c.useState)(0)),C=Object(p.a)(N,2),R=C[0],U=C[1],M=Object(c.useState)("input"),B=Object(p.a)(M,2),I=B[0],P=B[1],D=Object(b.createFFmpeg)({log:!1});Object(c.useEffect)((function(){(e=k.current.getContext("2d")).drawImage(S.current,0,0,k.width,k.height)}));var A,E=function(){var e=Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=5;break}return P("inputHidden"),setTimeout((function(){P("hidden")}),1e3),e.next=5,s(URL.createObjectURL(new Blob([j],{type:"video/mp4"})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(e){return new Promise((function(t){return setTimeout(t,e)}))},G=function(){var e=Object(l.a)(d.a.mark((function e(t){var n,c,a,s,u,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return new FileReader,e.next=3,D.load();case 3:return e.t0=D,e.next=6,Object(b.fetchFile)(j);case 6:e.t1=e.sent,e.t0.FS.call(e.t0,"writeFile","vid.mp4",e.t1),7,n=1,c=d.a.mark((function e(){var c,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(n),e.next=3,V(n);case 3:c=e.sent,a=!0,s=n+1;case 6:if(!a){e.next=38;break}return U(s/t*100),H(s),e.next=11,V(s);case 11:return l=e.sent,e.next=14,Y(c,l,7);case 14:if(e.t0=e.sent,!e.t0){e.next=17;break}e.t0=s-n>30;case 17:if(!e.t0){e.next=35;break}return e.next=20,q(n,s,"out.mp4");case 20:return u=e.sent,e.next=23,D.run.apply(D,Object(i.a)("-i out.mp4 out.wav".split(" ")));case 23:return e.t1=Blob,e.next=26,D.FS("readFile","out.wav").buffer;case 26:e.t2=e.sent,e.t3=[e.t2],e.t4={type:"audio/mp3"},o=new e.t1(e.t3,e.t4),g((function(e){return e.concat(Object(r.jsx)(x,{aud:o,vid:u,img:c,time:H(n)},n))})),a=!1,n=s+2,e.next=36;break;case 35:s+=1;case 36:e.next=6;break;case 38:case"end":return e.stop()}}),e)}));case 11:if(!(n<t)){e.next=15;break}return e.delegateYield(c(),"t2",13);case 13:e.next=11;break;case 15:U(0);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(e){return new Date(1e3*e).toISOString().substr(11,8)},V=function(){var t=Object(l.a)(d.a.mark((function t(n,r){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n;case 2:return S.current.currentTime=t.sent,t.next=5,e.drawImage(S.current,0,0,k.current.width,k.current.height);case 5:return t.next=7,k.current.toDataURL();case 7:return c=t.sent,t.next=10,J(50);case 10:return t.abrupt("return",c);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Y=function(){var e=Object(l.a)(d.a.mark((function e(t,n,r){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()(t).compareTo(n).onComplete((function(e){e.rawMisMatchPercentage>r?(console.log(e.rawMisMatchPercentage),A=!0):A=!1}));case 2:return e.sent,e.abrupt("return",A);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),q=function(){var e=Object(l.a)(d.a.mark((function e(t,n,r){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(H(t)),e.next=3,D.run.apply(D,Object(i.a)("-i vid.mp4 -ss ".concat(H(t)," -to ").concat(H(n)," -c:v copy -c:a copy ").concat(r).split(" ")));case 3:return e.next=5,D.FS("readFile",r);case 5:return c=e.sent,e.abrupt("return",URL.createObjectURL(new Blob([c.buffer],{type:"video/mp4"})));case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)("div",{className:"header",children:Object(r.jsx)("h1",{className:"name",children:"Slides to Article"})}),Object(r.jsx)(h.a,{color:"#f11946",progress:R,onLoaderFinished:function(){return U(0)}}),Object(r.jsxs)("div",{className:I,children:[Object(r.jsx)("p",{children:"This tool converts a recording of a lecture into a readable and searchable article. "}),Object(r.jsx)("p",{children:"Good lectures to use are voiceovers of slides without much else going on"}),Object(r.jsx)("br",{}),Object(r.jsx)("h2",{children:"Upload a file to get started"}),Object(r.jsx)("input",{type:"file",onChange:function(e){O(e.target.files[0])}}),Object(r.jsx)("button",{onClick:E,children:"Upload!"})]}),Object(r.jsx)("video",{className:"mainVid",ref:S,src:a,width:"250",controls:!0,onLoadedMetadata:function(e){G(e.target.duration)}}),Object(r.jsx)("canvas",{ref:k}),Object(r.jsx)("div",{className:"slides",children:w})]})},m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,58)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};u.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(O,{})}),document.getElementById("root")),m()}},[[57,1,2]]]);
//# sourceMappingURL=main.4a94b59a.chunk.js.map