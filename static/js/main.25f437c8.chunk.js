(this.webpackJsonptranscode2=this.webpackJsonptranscode2||[]).push([[0],{28:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),c=n.n(a),s=n(19),o=n.n(s),i=(n(28),n(11)),u=n(2),d=n.n(u),l=n(4),p=n(3),f=n(10),b=n(20),j=n.n(b),h=(n(56),n(21));var m=function(e){var t=Object(a.useState)("Lala here's some text that pocketsphinx should've made"),n=Object(p.a)(t,2),c=n[0];function s(e){var t=new Worker("/Transcript/sphinx/recognizer.js");t.onmessage=function(n){console.log("initialized!"),e(t)},t.postMessage({"pocketsphinx.js":"/Transcript/sphinx/pocketsphinx.js","pocketsphinx.wasm":"/Transcript/sphinx/pocketsphinx.wasm"})}return n[1],console.log(e.aud),Object(a.useEffect)((function(){var t=new AudioContext;new FileReader,new XMLHttpRequest;fetch(e.aud).then((function(e){return e.arrayBuffer()})).then(function(){var n=Object(l.a)(d.a.mark((function n(r){var a;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(r),n.next=3,t.decodeAudioData(r);case 3:a=n.sent,console.log(a),s((function(t){t.onmessage=function(e){console.log(e.data)};var n=e.time.replace(":","");t.postMessage({command:"initialize",callbackId:n});t.postMessage({command:"addGrammar",data:{numStates:3,start:0,end:2,transitions:[{from:0,to:1,word:"HELLO"},{from:1,to:2,logp:0,word:"WORLD"},{from:1,to:2}]},callbackId:n});t.postMessage({command:"addWords",data:[["ONE","W AH N"],["TWO","T UW"],["THREE","TH R IY"]],callbackId:n}),t.postMessage({command:"start",data:n}),t.postMessage({command:"process",data:a})}));case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())})),Object(r.jsx)("div",{children:Object(r.jsxs)("div",{className:"slide",children:[Object(r.jsx)("p",{className:"timeStamp",children:e.time}),Object(r.jsx)("video",{src:e.vid,width:"32%",controls:!0}),Object(r.jsx)("p",{className:"text",children:c})]})})};n(12),n(22);var x=function(){var e,t=Object(a.useState)(),n=Object(p.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)(),u=Object(p.a)(o,2),b=u[0],x=u[1],O=Object(a.useState)(!1),v=Object(p.a)(O,2),g=(v[0],v[1]),w=Object(a.useState)([]),k=Object(p.a)(w,2),S=k[0],y=k[1],L=Object(a.useRef)(null),F=Object(a.useRef)(null),R=Object(a.useState)(0),T=Object(p.a)(R,2),M=T[0],N=T[1],U=Object(a.useState)("input"),I=Object(p.a)(U,2),C=I[0],E=I[1],B=Object(f.createFFmpeg)({log:!1});Object(a.useEffect)((function(){(e=L.current.getContext("2d")).drawImage(F.current,0,0,L.width,L.height)}));var H,W=function(){var e=Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=6;break}return E("inputHidden"),setTimeout((function(){E("hidden")}),1e3),e.next=5,s(URL.createObjectURL(new Blob([b],{type:"video/mp4"})));case 5:g(!0);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(e){return new Promise((function(t){return setTimeout(t,e)}))},D=function(){var e=Object(l.a)(d.a.mark((function e(t){var n,a,c,s,o,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.load();case 2:return e.t0=B,e.next=5,Object(f.fetchFile)(b);case 5:e.t1=e.sent,e.t0.FS.call(e.t0,"writeFile","vid.mp4",e.t1),7,n=300,a=d.a.mark((function e(){var a,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(n),e.next=3,z(n);case 3:a=e.sent,c=!0,s=n+1;case 6:if(!c){e.next=40;break}return N(s/t*100),P(s),e.next=11,z(s);case 11:return l=e.sent,e.next=14,G(a,l,7);case 14:if(e.t0=e.sent,!e.t0){e.next=17;break}e.t0=s-n>30;case 17:if(!e.t0){e.next=37;break}return e.next=20,J(n,s,"out.mp4");case 20:return o=e.sent,e.next=23,B.run.apply(B,Object(i.a)("-i out.mp4 out.mp3".split(" ")));case 23:return e.t1=URL,e.t2=Blob,e.next=27,B.FS("readFile","out.mp3").buffer;case 27:e.t3=e.sent,e.t4=[e.t3],e.t5={type:"audio/mp3"},e.t6=new e.t2(e.t4,e.t5),u=e.t1.createObjectURL.call(e.t1,e.t6),y((function(e){return e.concat(Object(r.jsx)(m,{aud:u,vid:o,img:a,time:P(n)},n))})),c=!1,n=s+2,e.next=38;break;case 37:s+=1;case 38:e.next=6;break;case 40:case"end":return e.stop()}}),e)}));case 10:if(!(n<t)){e.next=14;break}return e.delegateYield(a(),"t2",12);case 12:e.next=10;break;case 14:N(0);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(e){return new Date(1e3*e).toISOString().substr(11,8)},z=function(){var t=Object(l.a)(d.a.mark((function t(n,r){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n;case 2:return F.current.currentTime=t.sent,t.next=5,e.drawImage(F.current,0,0,L.current.width,L.current.height);case 5:return t.next=7,L.current.toDataURL();case 7:return a=t.sent,t.next=10,A(50);case 10:return t.abrupt("return",a);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),G=function(){var e=Object(l.a)(d.a.mark((function e(t,n,r){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j()(t).compareTo(n).onComplete((function(e){e.rawMisMatchPercentage>r?(console.log(e.rawMisMatchPercentage),H=!0):H=!1}));case 2:return e.sent,e.abrupt("return",H);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),J=function(){var e=Object(l.a)(d.a.mark((function e(t,n,r){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(P(t)),e.next=3,B.run.apply(B,Object(i.a)("-i vid.mp4 -ss ".concat(P(t)," -to ").concat(P(n)," -c:v copy -c:a copy ").concat(r).split(" ")));case 3:return e.next=5,B.FS("readFile",r);case 5:return a=e.sent,e.abrupt("return",URL.createObjectURL(new Blob([a.buffer],{type:"video/mp4"})));case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)("div",{className:"header",children:Object(r.jsx)("h1",{className:"name",children:"Slides to Article"})}),Object(r.jsx)(h.a,{color:"#f11946",progress:M,onLoaderFinished:function(){return N(0)}}),Object(r.jsxs)("div",{className:C,children:[Object(r.jsx)("p",{children:"This tool converts a recording of a lecture into a readable and searchable article. "}),Object(r.jsx)("p",{children:"Good lectures to use are voiceovers of slides without much else going on"}),Object(r.jsx)("br",{}),Object(r.jsx)("h2",{children:"Upload a file to get started"}),Object(r.jsx)("input",{type:"file",onChange:function(e){x(e.target.files[0])}}),Object(r.jsx)("button",{onClick:W,children:"Upload!"})]}),Object(r.jsx)("video",{className:"mainVid",ref:F,src:c,width:"250",controls:!0,onLoadedMetadata:function(e){D(e.target.duration)}}),Object(r.jsx)("canvas",{ref:L}),Object(r.jsx)("div",{className:"slides",children:S})]})},O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,58)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};o.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(x,{})}),document.getElementById("root")),O()}},[[57,1,2]]]);
//# sourceMappingURL=main.25f437c8.chunk.js.map